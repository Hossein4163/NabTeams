# گزارش پیاده‌سازی تسک‌منیجر هوش مصنوعی NabTeams

این گزارش وضعیت نهایی پیاده‌سازی سامانه مدیریت تسک رویدادمحور برای شرکت‌کنندگان را جمع‌بندی می‌کند.

## ۱. نمای کلی قابلیت
- رویدادها اکنون دارای سوئیچ «فعال‌سازی تسک‌منیجر هوش مصنوعی» هستند که از مسیر `/dashboard/admin/events` و یا API `POST/PUT /api/events` توسط ادمین کنترل می‌شود.
- هر رویداد می‌تواند مجموعه‌ای از تسک‌های نمونه داشته باشد و در صورت فعال بودن، تیم‌های شرکت‌کننده‌ی متصل به آن رویداد امکان ایجاد، ویرایش، حذف و تغییر وضعیت تسک‌ها را پیدا می‌کنند.
- سرویس `GeminiTaskAdvisor` خلاصه وضعیت تیم، تسک‌های موجود و تمرکز انتخابی هد تیم را تحلیل کرده و پیشنهادهای جدید، ریسک‌ها و گام‌های بعدی را بازمی‌گرداند.

## ۲. تغییرات بک‌اند
- مدل‌های دامنه برای رویداد (`EventDetail`) و تسک تیم (`ParticipantTask`) به‌روزرسانی و با EF Core مپ شده‌اند؛ مایگریشن `20241012180000_AddEventTaskManager` جداول مرتبط را ایجاد می‌کند.
- سرویس‌های جدید `EventService`، `ParticipantTaskService` و `GeminiTaskAdvisor` در لایه Application/Infrastructure پیاده‌سازی و در `Program.cs` ثبت شده‌اند.
- کنترلرهای REST:
  - `EventsController` (عمومی برای GET، ادمین برای CRUD)؛
  - `ParticipantTasksController` برای CRUD تسک، تغییر وضعیت و درخواست پیشنهادهای AI، همراه با مدیریت خطا و پیام قابل‌فهم زمانی که رویداد این قابلیت را فعال نکرده است.
- تست‌های واحد جدید (`EventsControllerTests`, `ParticipantTasksControllerTests`) جریان‌های اصلی (موفق/ناموفق) را پوشش می‌دهند.

## ۳. تغییرات فرانت‌اند
- صفحهٔ «مدیریت رویدادها و تسک‌منیجر» امکان ساخت رویداد، تعیین بازه زمانی و فعال/غیرفعال‌سازی AI را فراهم می‌کند؛ لیست نمونه‌تسک‌ها نیز نمایش داده می‌شود.
- فرم ثبت‌نام شرکت‌کننده در مرحلهٔ اول انتخاب رویداد را اجباری کرده و پس از ارسال موفق، لینک «مدیریت تسک‌های تیم» را در صورت فعال بودن قابلیت نشان می‌دهد.
- داشبورد جدید `/dashboard/tasks` شامل:
  - جست‌وجوی شناسه ثبت‌نام و نمایش خلاصه تیم؛
  - ثبت، ویرایش، حذف و تغییر وضعیت تسک‌ها با بازخورد بلادرنگ؛
  - ماژول درخواست پیشنهاد هوش مصنوعی با نمایش خلاصه، تسک‌های پیشنهادی، ریسک‌ها و گام‌های بعدی؛
  - پیام راهنما در صورت غیرفعال بودن قابلیت برای رویداد.
- صفحهٔ اصلی و داشبورد وضعیت ثبت‌نام لینک دسترسی سریع به ماژول تسک‌منیجر را در اختیار کاربران قرار می‌دهد.

## ۴. پیکربندی و وابستگی‌ها
- برای بهره‌برداری باید:
  - حداقل یک رویداد از طریق داشبورد ادمین ایجاد و تسک‌منیجر آن فعال شود.
  - کلیدهای Gemini و سایر سرویس‌ها از مسیر `/dashboard/admin/integrations` یا متغیرهای `INTEGRATIONS__*` مقداردهی شوند.
  - مسیر ذخیره‌سازی مدارک (`Registration__StoragePath`) و در صورت نیاز فایل‌های عملیات/تسک در زیرساخت آماده باشد.
- شرکت‌کنندگان تنها با داشتن شناسه ثبت‌نام می‌توانند به تسک‌ها دسترسی داشته باشند؛ برای امنیت بیشتر توصیه می‌شود شناسه‌ها در اختیار افراد غیرمرتبط قرار نگیرد.

## ۵. وضعیت آزمون و محدودیت محیطی
- در محیط CI فعلی امکان اجرای `dotnet test` و `npm run lint` وجود نداشت (نبود CLI و ویزارد تعاملی)، اما تست‌های واحد جدید افزوده شده و باید در محیط واقعی اجرا شوند.
- هنگام استقرار، اجرای مجدد مایگریشن‌ها (`dotnet ef database update`) و بررسی صحت کلیدهای یکپارچه‌سازی الزامی است.

## ۶. گام‌های پیشنهادی بعدی
- یکپارچه‌سازی سرویس تسک با سیستم احراز هویت نهایی (برای محدود کردن دسترسی به تیم‌های مجاز).
- افزودن اعلان‌های خودکار هنگام ایجاد/تکمیل تسک برای اعضای تیم از طریق سرویس ایمیل/پیامک.
- پیاده‌سازی تست‌های انتها-به-انتها (E2E) برای ویزارد ثبت‌نام و داشبورد تسک در محیطی که ESLint و Playwright به صورت غیرتعاملی پیکربندی شده باشند.
